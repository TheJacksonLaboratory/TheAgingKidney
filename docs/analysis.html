<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />


<meta name="author" content="Yuka Takemon" />


<title>Analyses</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}

.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->




<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = false;
    options.smoothScroll = false;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
  padding-left: 25px;
  text-indent: 0;
}

.tocify .list-group-item {
  border-radius: 0px;
}

.tocify-subheader {
  display: inline;
}
.tocify-subheader .tocify-item {
  font-size: 0.95em;
}

</style>

<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">



<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <!-- NOTE: add "navbar-inverse" class for an alternate navbar background -->
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">The Aging Kidney</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li><a href="index.html">Home</a></li>
        <li><a href="about.html">About</a></li>
        <li><a href="data.html">Data</a></li>
        <li><a href="analysis.html">Analyses</a></li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li><a href="https://github.com">GitHub</a></li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Analyses</h1>
<h4 class="author"><em>Yuka Takemon</em></h4>
<h4 class="date"><em>25 May, 2018</em></h4>

</div>


<div id="calculating-anovas" class="section level1">
<h1><span class="header-section-number">1</span> Calculating ANOVAs</h1>
<p>For each gene that we have both mRNA and protein expression data, we fitted a linear model <span class="math display">\[ y_{i} \sim Age + Sex + Generation \]</span> We will be using the recorded slope and p-value from each mRNA and protein in the downstream processes.</p>
<div id="running-anova-script" class="section level2">
<h2><span class="header-section-number">1.1</span> Running ANOVA script</h2>
<p>The following bash script is designed to submit the ANOVA R script to the cluster that utilizes PBS submission. You must submit the .Rdata and name the output file in this order. The .Rdata and Rscirpt can be found <span style="color:red">HERE (insert R script later)</span></p>
<p><span style="color:red">Link to Rmd page</span></p>
<pre class="bash"><code>qsub -v I=&quot;./DO188b_kidney_noprobs.RData ./kidney_anova_slope_output.csv&quot;,script=anova_tests_slope_pairs Rsubmit_args.sh</code></pre>
<p>This will submit the R script to another script Rsubmit_args.sh, which will run the R script in the R environment within the allocated resource.</p>
<pre class="bash"><code>#!/bin/bash -l
#PBS -l nodes=1:ppn=3,walltime=03:00:00

# Usage:
# qsub -v I=${from list},script=${R script name} Rsubmit_multiple.R

cd /projects/korstanje-lab/ytakemon/JAC_DO_Kidney/Scripts/ANOVA
module load R/3.3.2

# I is the input variable
R --no-save --args ${I} &lt; ${script}.R &gt; ${script}.Rout</code></pre>
<p><span style="color:red">Link to ANOVA histogram page</span></p>
<p><span style="color:red">Link to direction of change page</span></p>
<p><br> <br> <br></p>
</div>
</div>
<div id="histograms-of-anova-p-values" class="section level1">
<h1><span class="header-section-number">2</span> Histograms of ANOVA p-values</h1>
<p>For each gene that we have both mRNA and protein expression data, we fitted a linear model <span class="math display">\[ y_{i} \sim Age + Sex + Generation \]</span> and then tested the significance of the effects Age, Sex, and Age:Sex interaction. The figures below visualizes the distribution of the tests’ p-values and compares them between the effects Age, Sex, and Age:Sex interaction.</p>
<p>We found that the effect of sex on mRNA was stronger than the effects of Age, which is to be expected. However we saw that the proteins seem to be strongly affected by both sex and age, which we suspect is due to batch a effect that unfortunately coincided with the age of the samples (not 100% overlap).</p>
<p><span style="color:red">Link to Rmd page</span></p>
<div id="effects-on-mrna" class="section level2">
<h2><span class="header-section-number">2.1</span> Effects on mRNA</h2>
<p><img src="analysis_files/figure-html/plotting%20mRNA-1.png" width="960" style="display: block; margin: auto;" /></p>
</div>
<div id="effects-on-protein" class="section level2">
<h2><span class="header-section-number">2.2</span> Effects on protein</h2>
<p><img src="analysis_files/figure-html/plotting%20protein-1.png" width="960" style="display: block; margin: auto;" /></p>
</div>
<div id="effects-of-agesex-interaction-on-mrna-and-protein" class="section level2">
<h2><span class="header-section-number">2.3</span> Effects of Age:Sex interaction on mRNA and protein</h2>
<p><img src="analysis_files/figure-html/plotting%20age/sex%20interaction-1.png" width="960" style="display: block; margin: auto;" /></p>
<p><br> <br> <br></p>
</div>
</div>
<div id="direction-of-change-with-age" class="section level1">
<h1><span class="header-section-number">3</span> Direction of Change with Age</h1>
<p>For each gene that we have both mRNA and protein expression data, we fitted a linear model <span class="math display">\[ y_{i} \sim Age + Sex + Generation \]</span> and then tested the significance of the effects Age and recorded its p-values and slope. For the 6667 genes for which we have both mRNA and protein expression data, we can illustrate the distinct changes in expression with age and identify those that are significant.</p>
<p>In our manuscript we analysed the significant quadrants, colored in purple below, using the Ingenuity Pathway Analysis (IPA) to identify enriched biological pathways. To see our findings please refer to our manuscript.</p>
<p><span style="color:red">Link to Rmd page</span>    </p>
<p><img src="analysis_files/figure-html/plotting-1.png" width="672" style="display: block; margin: auto;" /></p>
<p><span style="color:red">Link to output file that will need to be incorporated</span></p>
<p><br> <br> <br></p>
</div>
<div id="the-ecological-fallacy" class="section level1">
<h1><span class="header-section-number">4</span> The Ecological Fallacy</h1>
<p>Previously we showed how mRNA and protein expression changed with age. We want to highlight a few genes to explain what is known as “The ecological fallacy”, whereby total correlation is not the same as individual group correlation.</p>
<p><img src="images/EcoFallacy.png" width="80%" /></p>
<div id="an-example-of-slc9a3" class="section level2">
<h2><span class="header-section-number">4.1</span> An example of Slc9a3</h2>
<p>Slc9a3 was highlighted in our manuscript as a gene found to have decreasing mRNA but increasing protein with age. Slc9a3 is a gene that encodes for a Na/H exchange found on the brush boarder of the proximal tubule. Although the total changes show that Slc9a3 mRNA is decreasing with age and SLC9A3 proteins are increasing with age, we find that on a individual group level (by sex and age) they are similarly positively correlated. <br></p>
<p><img src="analysis_files/figure-html/plot%20from%20paper-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>Although for us Slc9a3 is a biologically interesting gene, it’s difficult to see the ecological fallacy. Below are some clear examples.</p>
</div>
<div id="best-examples" class="section level2">
<h2><span class="header-section-number">4.2</span> Best examples</h2>
<p>We picked Slc5a12 and Flot1 as the best examples of this ecological fallacy.</p>
<p>Slc5a12 is an example whereby the mRNA expression decreased and the protein expression increased with age. As you can see there is not shift at 6 and 12 months, but at 18 months of age the average of the group shifts to the top right. The upward shift indicates that the protein expression increased but the leftward shift indicates the decrease of mRNA expression. Again, note that the individual group level are similarly positively correlated.</p>
<p>Flot1 is an example where by the mRNA expression increases with age and the protein expression decreases with age. You can observe the down and rightward shift of the lines with age. The downward shift indicates a decrease in protein expression, and a rightward shift indicates a increase in mRNA expression with age. <br></p>
<p><img src="analysis_files/figure-html/best%20examples-1.png" width="960" style="display: block; margin: auto;" /></p>
<p><br> <br> <br></p>
</div>
</div>
<div id="relating-to-renal-physiology" class="section level1">
<h1><span class="header-section-number">5</span> Relating to renal physiology</h1>
<p><br></p>
<div id="slc34a1-and-phosphate" class="section level2">
<h2><span class="header-section-number">5.1</span> Slc34a1 and Phosphate</h2>
<p><img src="analysis_files/figure-html/unnamed-chunk-1-1.png" width="672" /></p>
<p><br></p>
</div>
<div id="slc34a3-and-phosphate" class="section level2">
<h2><span class="header-section-number">5.2</span> Slc34a3 and Phosphate</h2>
<p><img src="analysis_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<p><br></p>
</div>
<div id="lrp2-and-albumin" class="section level2">
<h2><span class="header-section-number">5.3</span> Lrp2 and Albumin</h2>
<p><img src="analysis_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<p><br> <br> <br></p>
</div>
</div>
<div id="session-information" class="section level1">
<h1><span class="header-section-number">6</span> Session Information</h1>
<pre class="r"><code>sessionInfo()</code></pre>
<pre><code>## R version 3.5.0 (2018-04-23)
## Platform: x86_64-apple-darwin15.6.0 (64-bit)
## Running under: macOS Sierra 10.12.6
## 
## Matrix products: default
## BLAS: /Library/Frameworks/R.framework/Versions/3.5/Resources/lib/libRblas.0.dylib
## LAPACK: /Library/Frameworks/R.framework/Versions/3.5/Resources/lib/libRlapack.dylib
## 
## locale:
## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
##  [1] bindrcpp_0.2.2  ggsci_2.9       gridExtra_2.3   forcats_0.3.0  
##  [5] stringr_1.3.1   dplyr_0.7.5     purrr_0.2.4     readr_1.1.1    
##  [9] tidyr_0.8.1     tibble_1.4.2    ggplot2_2.2.1   tidyverse_1.2.1
## 
## loaded via a namespace (and not attached):
##  [1] tidyselect_0.2.4 reshape2_1.4.3   haven_1.1.1      lattice_0.20-35 
##  [5] colorspace_1.3-2 htmltools_0.3.6  yaml_2.1.19      rlang_0.2.0     
##  [9] pillar_1.2.2     foreign_0.8-70   glue_1.2.0       modelr_0.1.2    
## [13] readxl_1.1.0     bindr_0.1.1      plyr_1.8.4       munsell_0.4.3   
## [17] gtable_0.2.0     cellranger_1.1.0 rvest_0.3.2      psych_1.8.4     
## [21] evaluate_0.10.1  labeling_0.3     knitr_1.20       parallel_3.5.0  
## [25] broom_0.4.4      Rcpp_0.12.17     scales_0.5.0     backports_1.1.2 
## [29] jsonlite_1.5     mnormt_1.5-5     hms_0.4.2        digest_0.6.15   
## [33] stringi_1.2.2    grid_3.5.0       rprojroot_1.3-2  cli_1.0.0       
## [37] tools_3.5.0      magrittr_1.5     lazyeval_0.2.1   crayon_1.3.4    
## [41] pkgconfig_2.0.1  xml2_1.2.0       lubridate_1.7.4  assertthat_0.2.0
## [45] rmarkdown_1.9    httr_1.3.1       rstudioapi_0.7   R6_2.2.2        
## [49] nlme_3.1-137     compiler_3.5.0</code></pre>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
